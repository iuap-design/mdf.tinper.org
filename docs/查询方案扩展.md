> 创建者：姚磊
> 创建时间：2019-10-17
> 修改者：
> 修改时间：


<a name="hZaiY"></a>
# 查询方案扩展
由于查询区的UI元数据不随标准协议接口返回，在单据的扩展脚本的viewmodel中无法获取查询区的字段模型，因此查询区可以增加单独的扩展脚本，在扩展脚本中实现类似模板扩展脚本中的交互。查询区扩展脚本也是放在business文件夹中。
<a name="nbKfH"></a>
## 1 命名规则
查询区的扩展文件名是在excel中配置的。在excel中[pb_meta_filters]表中behaviorObject字段定义当前查询区扩展文件的路径，如果excel中无此列字段可手动添加。查询区扩展脚本也放在子产品编码文件夹下。<br />默认规范：'子产品编码_'+'单据编码_'+'filterVM.Extend.js'。<br />**eg:** EMM_emm_inspectstd_list_filterVM.Extend.js<br />![image.png](http://design.yonyoucloud.com/static/yuque/0/2019/png/271337/1571140914231-019a19ad-b38e-4c81-9241-9e500eda3a79.png#align=left&display=inline&height=148&name=image.png&originHeight=296&originWidth=922&search=&size=34910&status=done&width=461)

** 注：** 查询区扩展脚本定义需加上子产品编码文件夹路径，如：EMM/EMM_emm_inspectstd_list_filterVM.Extend.js

<a name="fmlv7"></a>
## 2 加载流程和逻辑
在查询区的公共脚本（filterViewModel.js）中一段代码用于加载查询区的扩展脚本，如下：

```javascript
proxy.getInitFilterInfo(params, function (errors, results) {
    ......
    if (data && data.behaviorObject && !extendInit) {
        ......
        cb.require([data.behaviorObject], function (extend) {
            extend.doAction('init', viewModel);
            self.extendReady1(viewModel, results, solutionId, viewId);
        }, function (error) {
            console.error(error.message);
            self.extendReady1(viewModel, results, solutionId, viewId);
        })
    }
    ......
});
```

<a name="KxM8q"></a>
## 3 使用方式
查询区扩展脚本的使用方式和单据扩展一致。