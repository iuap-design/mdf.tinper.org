改造原有的`yxyweb`超大集合，拆分为@mdf/cube、@mdf/metaui-web、@mdf/middlewares-auth、@mdf/middlewares-log4js、@mdf/plugin-meta、@mdf/theme 等包目的是解耦版本化管理。

**MDF2.0提供脚手架@mdf-app，可以使用该脚手架进行开发，不建议手动升级原有脚手架，这样误差较多**

<a name="1UkmU"></a>
## 1、安装依赖包
由于MDF2.0的包不开源，故发布在内网ynpm仓库下，需要安装ynpm-tool工具，安装如下：
> 外网可以VPN到集团内网也可以使用ynpm


```bash
# 安装工具到全局命令cli
# 参考文档 https://package.yonyoucloud.com

npm install ynpm-tool -g
```

安装对应依赖包，使用@mdf-app脚手架可以免去手动安装依赖

```bash
# 使用ynpm install来安装对应的@mdf包
# 具体包如下：

  "dependencies": {
    "@mdf/cube": "^1.0.0",
    "@mdf/metaui-mobile": "^1.0.0",
    "@mdf/metaui-web": "^1.0.0",
    "@mdf/metaui-web-ncc": "^1.0.0",
    "@mdf/middlewares-auth": "^1.0.0",
    "@mdf/middlewares-log4js": "^1.0.0",
    "@mdf/plugin-meta": "^1.0.0",
    "@mdf/theme": "^1.0.0"
}
```

<a name="cpeuc"></a>
## 2、修改webapck配置
> 原有脚手架工程使用的是webpack3版本，最新MDF2.0中升级到最新的webpack4版本

MDF2.0中，webpack做了以下修改：

- 将多个配置文件合并。现在仅需要两个配置文件，webpack.dll.config.js和webpack.config.js，分别用来控制dll和应用的构建。
- 升级了webpack版本至v4，然后相应地更新配置文件，可参见官方提供的[升级文档](https://webpack.js.org/migrate/4/)，主要包括两个部分：
  - 添加mode属性，可选值为production和development
  - 一些插件现在改为内置，不再需要引入了，如uglifyjs。

```javascript
var origin = [
  path.resolve('src/common'),
  path.resolve('src/client'),
  path.resolve('node_modules/@mdf'),
  path.resolve('src/mobile'),
  path.resolve('src/web')
];
```

<a name="YIFkC"></a>
## 3、修改package.json启动命令
使用mdf-app脚手架里面的package.json文件替换即可

<a name="F7Evq"></a>
## 4、修改babel.config.js

```javascript
module.exports = {
  "presets": [
    "@babel/preset-env",
    "@babel/preset-react"
  ],
  "plugins": [
    [
      "module-resolver",
      {
        "alias": {
          "src": process.env.MDF_TARGET === "mobile" ? "./src/mobile" : "./src/web",
          "web": "./src/web",
          "client": "./src/client",
          "business": "./src/business",
          "static": "./static"
        }
      }
    ],
    "@babel/plugin-syntax-dynamic-import",
    "@babel/plugin-syntax-import-meta",
    "@babel/plugin-proposal-class-properties",
    "@babel/plugin-proposal-json-strings",
    [
      "@babel/plugin-proposal-decorators",
      {
        "legacy": true
      }
    ],
    "@babel/plugin-proposal-function-sent",
    "@babel/plugin-proposal-export-namespace-from",
    "@babel/plugin-proposal-numeric-separator",
    "@babel/plugin-proposal-throw-expressions",
    "@babel/plugin-proposal-export-default-from",
    "@babel/plugin-proposal-logical-assignment-operators",
    "@babel/plugin-proposal-optional-chaining",
    [
      "@babel/plugin-proposal-pipeline-operator",
      {
        "proposal": "minimal"
      }
    ],
    "@babel/plugin-proposal-nullish-coalescing-operator",
    "@babel/plugin-proposal-do-expressions"
  ],
  "env": {
    "development": {
      "plugins": [ 'react-hot-loader/babel' ]
    }
  }
}

```