<a name="IgHH2"></a>
## 一、现状


| **工程** | **脚手架工程体积** | **工程包下载时间** | **包体积大小**<br />**（****优化前****）** | **包体积大小**<br />**（****优化后****）** |
| --- | --- | --- | --- | --- |
| 开发平台示例工程 | 不含vendor等资源，708K | added 1804 packages from 1093 contributors in 146.832s | index.min.js（5.4 MB）<br />vendor.min.js（1.6 MB，未压缩6.3M）<br />index.min.css（2.8 MB） | 去掉echarts、amap后：<br />index.min.js<br />vendor.min.js（896 KB） |
| U订货 | 不含vendor等资源，2.9M | added 1809 packages from 1061 contributors in 37.835s | index.min.js(5MB)<br />vendor.min.js(420KB) |  |
| 财务云 | 不含vendor等资源，3.8M | added 1564 packages from 951 contributors in 39.826s | index.min.js（4.4M）<br />vendor.min.js（1.5M） |  |
| 人员 | 不含vendor等资源，64.3M，包含home、excel资源 | added 2106 packages from 1160 contributors in 47.528s | index.min.js (3.9MB)<br />vendor.min.js(2.2MB) |  |
| 库存云&基础服务 | 不含vendor等资源，61.3M，包含home、image大图、u8c-components资源 | added 2099 packages from 1160 contributors in 50.272s | index.min.js (4.7MB)<br />vendor.min.js (2.2MB) |  |
| 制造云-工程数据 | 不含vendor等资源，57.4M，包含home、image大图、u8c-components资源 | added 2099 packages from 1160 contributors in 78.554s | index.min.js (4.6MB)<br />vendor.min.js (2.2MB) |  |





<a name="FesxE"></a>
## 二、目标

| 脚手架工程体积 | 工程包下载时间 | 包体积大小 |
| --- | --- | --- |
| 1M以内 | 30S以内 | index.min.js 小于700k<br />vendor.min.js 小于500k |
|  |  |  |



<a name="YMQt4"></a>
## 三、解决方案及执行

1、在 `packages` 下面建立与 `mdf-app` 平行的 `mdf-app-pub` 脚手架工程，脚手架工程中去掉 `webpack.dll` 配置等文件，以及无关的图片等资源，在不包括vendor资源前，体积要小于1M。<br />2、在mdf-app中打包产出以下资源：

- `mdf-verndor.min.js` 、`mdf-verndor.min.js.map` 、
- `mdf-framework.min.js` 、`mdf-framework.min.js.map` 

以上资源放到 `mdf-app-pub` 的 `static` 目录下，并在 `html.jsx` 提前加载。<br />3、修改 `webpack.config.js`  配置文件，配置 `external` 去掉已经打包好的资源；修改 `package.json` ，去掉已经打包好的资源依赖。<br />4、支持开发者打包产出业务工程的 `index.min.js` 文件


<a name="nYYC0"></a>
## 四、index.js 体积现状

| 包或文件 | 分类 | 未压缩前 | 压缩后 |
| --- | --- | --- | --- |
| public/javascripts/index.js  |  | 13.06M | 5.15M |
| 第三方 | lodash | 527K | 69K |
|  | g6.js | 306k | 305k |
|  | antd | 760K | 304K |
|  | echarts-for-react | 1.5M | 538K |
| <br /><br />components全量 | lib | 2.94M | 1.35M |
|  | echart类组件 | 560k | 269K |
|  |  |  |  |
| cube |  | 625k | 290K |
| iconfont.css |  | 927k |  |