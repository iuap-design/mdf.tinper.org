<a name="ace32fc8"></a>
## 专属化的多语方案

优点

1. 直接上传源码，把源码转换成标签的形式，能兼容react、jquery 等。

2. 一套资源，通过标签的属性，来进行多语的查找、替换。

3. 有线上工具。

缺点

1. 属于半自动化工具，不支持变量，没有对中文语意，进行区分。

2. 需要维护编译后的代码。

[专属化国际化](http://pap-i18n.online.app.yyuap.com/I18n/i18n/index.html#/)[在线]()[生成]()[资源]()

<a name="be60213e"></a>
## i18n 多语

1. 把代码打包成多套资源源码。

2. 提供工具进行快速编译，不用维护编译后的代码。
<a name="50P3Y"></a>
## 
<a name="PIZq2"></a>
## 我们采用的多语方案

1. 一套源码，通过多套静态资源进行加载。

2. 在静态资源、翻译文档中可以穿插变量、利用 Underscore 模版引擎的－template进行替换。

3. 在渲染之前还可以做自定义的规则渲染。

<a name="7d3e85cc"></a>
## 前端多语

<a name="fd421519"></a>
#### 1. React 普通项目静态资源国际化

> 1. 多语访问方式:
> 
通过http://ip:8080?locale=zh-CN/zh-TW/en-US 进行多语切换、cookie均可。
> 
> 2. [多语服务平台](http://workbench.yyuap.com/multilang-fe/#/dev)
> 


1. 静态资源的国际化，是通过cli 工具提取中文，把中文替换成 api 的方式。

```javascript
let _title = "我是变量的多余!";
    
 转换后
    
 let _title = `${lang.template("YS_FI_FP_0000033576")}`/* 我是变量的多余! */;
```

2. 提供 **ac-lang-cn **组件  [如何使用](https://package.yonyoucloud.com/#/package/YWMtbGFuZy1jbg==)

```javascript
  安装
  ynpm install ac-lang-cn --save

  引入
  import lang from 'ac-lang-cn'

  使用
  
  lang.init(pack); //初始化
```


4. pack 为资源文件。格式如下:

```javascript

module.exports={
  "zhcn": {
  	  "YS_FI_FP_000003484632": "大前端技术部",
  },
  "zhtw": {
    "YS_FI_FP_000003484632": "大前端技術部",
  },
  "enus": {
    "YS_FI_FP_000003484632": "FED",
  }
}
```

5. 在工程的入口引入如下代码。

```javascript
    import lang ,{ Local } from "ac-lang-cn";
    const pack = require('components/lang/pack').default;
    lang.init(pack, null);
    console.log(" ************************多语加载成功!***************************");
    
```

6. 完整示例 

```javascript
render(){
  let _title = `${lang.template("YS_FI_FP_0000033576")}`/* 我是变量的多余! */;
  return(<div>{_title}</div>)
}
```


<br />~~ over ~~<br />


<a name="EIeRf"></a>
#### 2. Ucf 项目静态资源国际化   

1. 提供 **ac-lang-cn **组件  [如果使用](https://package.yonyoucloud.com/#/package/YWMtbGFuZy1jbg==)

```javascript
  安装
  ynpm install ac-lang-cn --save
 
```

2. 新增一个index.js



```javascript
import {Locale} from "tinper-bee";
import lang ,{ Local } from "ac-lang-cn";
import React from 'react';
import mirror, { render, Router } from 'mirrorx';
import Routes from './routes';

// 全局样式
import './app.less';

// 设置mirrorx 路由加载方式
mirror.defaults({
    historyMode: "hash"
});

render(
  <Local Locale={Locale}>
    <Router>
      <Routes />
    </Router>
  </Local>, document.querySelector("#app"));
```


3. 在工程的入口app.js引入如下代码。

```javascript
import lang from "ac-lang-cn";
const pack = require('components/lang/pack.js');//.default;
lang.init(pack, null);
console.log(" ************************多语加载成功!***************************");
require('./index');
```
 

3. pack 为资源文件。格式如下:

```javascript

module.exports={
  "zhcn": {
  	  "YS_FI_FP_000003484632": "大前端技术部",
  },
  "zhtw": {
    "YS_FI_FP_000003484632": "大前端技術部",
  },
  "enus": {
    "YS_FI_FP_000003484632": "FED",
  }
}
```


<br />~~ over ~~<br />


<a name="FRtt6"></a>
#### MDF 2.0 项目中资源国际化
 

1. **组织 pack.js 文件，包含需要的语种,放到mdf-app/src/pack.js 下。**



```javascript
module.exports={
  "zhcn": {
  	  "YS_FI_FP_000003484632": "大前端技术部",
  },
  "zhtw": {
    "YS_FI_FP_000003484632": "大前端技術部",
  },
  "enus": {
    "YS_FI_FP_000003484632": "FED",
  }
}
```


3. **mdf-app/src/web/client/index.jsx 文件中填写如下代码**

```javascript
if(process.env.__LANG__ && process.env.__LANG__ == true){
    cb.lang.jsonp(0, 'YS_FED_FW,XX');
    cb.lang.init(require('../../pack'),null);
    console.log(" ************************多语加载成功!***************************");
    console.log(cb.lang.template("YS_FI_FP_000003484632"));
}
```

>注意事项:
> 1. cb.lang.jsonp   表示是否需要调用统一的多语服务来请求资源。
>   1. 参数二 ： 租户信息，不传默认为系统，系统为0租户
>   1. 参数二 ： 需要从哪几个组里面加载资源。
> 
> 2. cb.lang.init 初始化多语框架。
>   1. 参数一：获取项目中的多语词条。
>   1. YS_FED_FW 默认为mdd的,加上自己的组即。
>   1. 参数二：是否要指定从哪里获取语种信息。null 默认是从cookie、url 、系统默认的顺序获取。
> 
> 3. cb.lang.template("YS_FI_FP_000003484632") 测试可翻译的词条



4. **mdf-app/src/web/server/index.js**

```javascript
if(process.env.LANG && process.env.LANG == 'true'){
    let cb = {};
    cb.lang = require('@mdf/cube/lib/lang');
    cb.lang.setLanguage(require('../../pack'),"zh-CN");
    console.log(" ************************server-多语加载成功!***************************");
    console.log(cb.lang.template("YS_FI_FP_000003484632"));
    global.cb = cb;
  }
```

>注意事项:
> 1. setLanguage  服务器端获取语种信息
>   1. 参数二 ： 获取项目中的多语词条。
>   1. 参数二 ：设置默认语种。
> 
> 2. cb.lang.template("YS_FI_FP_000003484632") 测试可翻译的词条


4. **webpack.config**

```javascript
new webpack.DefinePlugin({
   
  'process.env.__LANG__': process.env.LANG, 
})
```

5. **package.json 启动命令中需要加载多语的都需要加上  LANG=true 加上**

```json
"scripts": {
"start": "cross-env NODE_ENV=production LANG=true babel-node --only=src,node_modules/@mdf bin/web/server/index.js",
"start:daily": "cross-env NODE_ENV=production LANG=true SERVER_ENV=daily babel-node --only=src,node_modules/@mdf bin/web/server/index.js",
"debug:web": "concurrently "npm run debug:client" "npm run debug:server"",
"debug:web:ncc": "concurrently "npm run debug:client" "npm run debug:server:daily"",
"debug:mobile": "concurrently "npm run debug:mobile:client" "npm run debug:mobile:server"",
"build:web": "concurrently "npm run build:client" "npm run build:server"",
"build:mobile": "concurrently "npm run build:mobile:client" "npm run build:mobile:server"",
"_comment_main_end": "主要命令区域",
"comment_seperator": " = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = ",
"_comment_other_start": "其它命令区域",
"start": "cross-env NODE_ENV=production SERVER_ENV=prod node bin/web/server/index.js",
"start:test": "cross-env NODE_ENV=production SERVER_ENV=test node bin/web/server/index.js",
"start:pre": "cross-env NODE_ENV=production SERVER_ENV=pre node bin/web/server/index.js",
"start:daily": "cross-env NODE_ENV=production SERVER_ENV=daily node bin/web/server/index.js",
"start:dev": "cross-env NODE_ENV=production SERVER_ENV=dev node bin/web/server/index.js",
"debug:client": "cross-env BABEL_ENV=development LANG=true NODE_ENV=development webpack-dev-server --progress --colors  --config webpack.config.js",
"debug:server": "cross-env BABEL_ENV=production NODE_ENV=development SERVER_ENV=prod LANG=true  nodemon -w src/web/server -w src/web/common --exec babel-node --only=src,node_modules/@mdf  --inspect src/web/server/index.js",
"debug:server:daily": "cross-env BABEL_ENV=production NODE_ENV=development SERVER_ENV=daily LANG=true  nodemon -w src/web/server -w src/web/common --exec babel-node --only=src,node_modules/@mdf  --inspect src/web/server/index.js",
"debug:server:test": "cross-env BABEL_ENV=production NODE_ENV=development SERVER_ENV=test   LANG=true  nodemon -w src/web/server -w src/web/common --exec babel-node --only=src,node_modules/@mdf  --inspect src/web/server/index.js",
"debug:server:dev": "cross-env BABEL_ENV=production NODE_ENV=development SERVER_ENV=dev     LANG=true  nodemon -w src/web/server -w src/web/common --exec babel-node --only=src,node_modules/@mdf  --inspect src/web/server/index.js",
"debug:mobile:client": "cross-env BABEL_ENV=development LANG=true MDF_TARGET=mobile webpack-dev-server --progress --profile --colors  --config webpack.config.js",
"debug:mobile:server": "cross-env BABEL_ENV=production NODE_ENV=development MDF_TARGET=mobile LANG=true  nodemon -w src/mobile/server -w src/mobile/common --exec babel-node --only=src,node_modules/@mdf  --inspect src/mobile/server/index.js",
"debug:mobile:server:daily": "cross-env BABEL_ENV=production NODE_ENV=development MDF_TARGET=mobile SERVER_ENV=daily LANG=true  nodemon -w src/mobile/server -w src/mobile/common --exec babel-node --only=src,node_modules/@mdf  --inspect src/mobile/server/index.js",
"build:mobile:client": "cross-env BABEL_ENV=production LANG=true NODE_ENV=production MDF_TARGET=mobile webpack --config webpack.config.js --colors --progress && echo '移动程序：编译完成'",
"build:mobile:server": "cross-env BABEL_ENV=production NODE_ENV=production MDF_TARGET=mobile babel src -d bin --ignore src/web/client,src/business && echo '后端程序：编译完成'",
"build:dll:dev": "cross-env NODE_ENV=development webpack --config webpack.dll.config.js",
"build:dll:prod": "cross-env NODE_ENV=production webpack --config webpack.dll.config.js",
"build:dll": "npm run build:dll:dev && npm run build:dll:prod",
"build:server": "cross-env BABEL_ENV=production NODE_ENV=production babel src -d bin --ignore src/web/client,src/business && echo '后端程序：编译完成'",
"build:client": "cross-env BABEL_ENV=production LANG=true NODE_ENV=production webpack --config webpack.config.js --colors --progress && echo '前端程序：编译完成'",
"prebuild": "npm run clean",
"clean": "rimraf ./bin",
"_comment_other_end": "其它命令区域"
}
```

6. 配置最新的包

```jsx
 "devDependencies": {
    "@mdf/baseui": "lang",
    "@mdf/cube": "lang", 
    "@mdf/metaui-web": "lang",
    "@mdf/middlewares-auth": "lang",
    "@mdf/plugin-meta": "lang"
}
```

 

5. 删除项目中的  node_modules 重新执行 ynpm i <br />
<br />~~ over ~~ 

<a name="PQ82f"></a>
#### MDF 2.0 使用多语录入控件

```javascript
cControlType 类型为 InputMultiLang 即可
```

<a name="kBzAd"></a>
#### 普通项目中使用多语录入控件 [ac-input-locale](https://package.yonyoucloud.com/#/package/YWMtaW5wdXQtbG9jYWxl)

```json
$ ynpm install ac-input-locale --save-dev

引入

import AcInputLocale from 'ac-input-locale';

样式引入

import 'ac-input-locale/dist/index.css';

```